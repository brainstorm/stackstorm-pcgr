---
chain:
  - name: "up"
    # ref: pcgr.aws_up
    ref: "core.local"
    parameters:
      #uuid: "{{ action_context.parent.execution_id }}"
      cmd: "echo 'Instance up' {{ action_context.parent.execution_id }}"
    notify:
      on-success:
        routes:
          - chatops
        message: "AWS instance up for PCGR"
      on-failure:
        routes:
          - chatops
        message: "Something went wrong instantiating AWS"
    on-success: "submit_vcf"
  - name: "submit_vcf"
    #ref: "pcgr.process"
    ref: "core.local"
    parameters:
      cmd: "echo 'In process' {{ action_context.parent.execution_id }} {{ chain_input }} {{ chain_output }}"
      #uuid: "{{ action_context.parent.execution_id }}"
      #input: "{{ chain_input }}"
      #output: "{{ chain_output }}"
    notify:
      on-success:
        routes:
          - chatops
        message: "PCGR processing done"
      on-failure:
        routes:
          - chatops
        message: "PCGR processing failed"
#  - name: "down"
#    ref: "pcgr.aws_down"
#    parameters:
#      #uuid: "{{ action_context.parent.execution_id }}"
#    notify:
#      on-success:
#        routes:
#          - chatops
#        message: "AWS instance up for PCGR"
#      on-failure:
#        routes:
#          - chatops
#        message: "Something went wrong instantiating AWS"
#    on-success: "submit_vcf"

default: "up"
